∏
jC:\Users\Matthieu\source\repos\HeroBot-deux-point-z√©ro\HeroBot.Plugins.Music\Attributes\VoiceAttribute.cs
	namespace 	
HeroBot
 
. 
Plugins 
. 
Music 
.  

Attributes  *
{ 
public		 

class		 
VoiceAttribute		 
:		  !!
PreconditionAttribute		" 7
{

 
private 
readonly 
bool 
_playerExists +
;+ ,
private 
readonly 
bool #
_needUserInVoiceChannel 5
;5 6
public 
VoiceAttribute 
( 
bool "
needPlayerExists# 3
,3 4
bool5 9"
needUserInvoicechannel: P
)P Q
{ 	
_playerExists 
= 
needPlayerExists ,
;, -#
_needUserInVoiceChannel #
=$ %"
needUserInvoicechannel& <
;< =
} 	
public 
override 
async 
Task "
<" #
PreconditionResult# 5
>5 6!
CheckPermissionsAsync7 L
(L M
ICommandContextM \
context] d
,d e
CommandInfof q
commandr y
,y z
IServiceProvider	{ ã
services
å î
)
î ï
{ 	
var 
musicService 
= 
services '
.' (

GetService( 2
<2 3
MusicService3 ?
>? @
(@ A
)A B
;B C
if 
( 
_playerExists 
&&  
!! "
musicService" .
.. /
GetLavalinkCluster/ A
(A B
)B C
.C D
	HasPlayerD M
(M N
contextN U
.U V
GuildV [
.[ \
Id\ ^
)^ _
)_ `
{ 
return 
PreconditionResult )
.) *
	FromError* 3
(3 4
$str4 _
)_ `
;` a
} 
if 
( #
_needUserInVoiceChannel '
&&( *
(+ ,
await, 1
context2 9
.9 :
Guild: ?
.? @
GetUserAsync@ L
(L M
contextM T
.T U
UserU Y
.Y Z
IdZ \
)\ ]
)] ^
.^ _
VoiceChannel_ k
==l n
nullo s
)s t
{ 
return 
PreconditionResult )
.) *
	FromError* 3
(3 4
$str4 W
)W X
;X Y
}   
return!! 
PreconditionResult!! %
.!!% &
FromSuccess!!& 1
(!!1 2
)!!2 3
;!!3 4
}"" 	
}## 
}$$ ﬁÈ
dC:\Users\Matthieu\source\repos\HeroBot-deux-point-z√©ro\HeroBot.Plugins.Music\Modules\MusicModule.cs
	namespace 	
HeroBot
 
. 
Plugins 
. 
Music 
.  
Modules  '
{ 
[ 

NeedPlugin 
] 
public 

class 
MusicModule 
: 

ModuleBase )
<) * 
SocketCommandContext* >
>> ?
{ 
private 
readonly 
MusicService %
_music& ,
;, -
public 
MusicModule 
( 
MusicService '
musicService( 4
)4 5
{6 7
_music 
= 
musicService !
;! "
} 	
[ 	
Voice	 
( 
false 
, 
true 
) 
] 
[ 	
Command	 
( 
$str 
) 
] 
public 
async 
Task 
Join 
( 
)  
{! "
var 
playerExists 
= 
_music %
.% &
GetLavalinkCluster& 8
(8 9
)9 :
.: ;
	GetPlayer; D
<D E
PlayerE K
>K L
(L M
ContextM T
.T U
GuildU Z
.Z [
Id[ ]
)] ^
;^ _
if 
( 
playerExists 
!= 
null  $
)$ %
{& '
await 

ReplyAsync  
(  !
$"! #(
I'm already connected to `<## ?
{? @
playerExists@ L
.L M
VoiceChannelIdM [
}[ \
>`\ ^
"^ _
)_ `
;` a
} 
var 
member 
= 
Context  
.  !
Guild! &
.& '
GetUser' .
(. /
Context/ 6
.6 7
User7 ;
.; <
Id< >
)> ?
;? @
var 
payer 
= 
await 
_music $
.$ %
GetLavalinkCluster% 7
(7 8
)8 9
.9 :
	JoinAsync: C
<C D
PlayerD J
>J K
(K L
ContextL S
.S T
GuildT Y
.Y Z
IdZ \
,\ ]
member^ d
.d e
VoiceChannele q
.q r
Idr t
)t u
;u v
payer   
.   
Channel   
=   
Context   #
.  # $
Channel  $ +
;  + ,
await!! 

ReplyAsync!! 
(!! 
$"!! $
I'm now connected to `<#!! 7
{!!7 8
payer!!8 =
.!!= >
VoiceChannelId!!> L
}!!L M
>`!!M O
"!!O P
)!!P Q
;!!Q R
}"" 	
[$$ 	
Command$$	 
($$ 
$str$$ 
)$$ 
]$$ 
[%% 	
Voice%%	 
(%% 
true%% 
,%% 
true%% 
)%% 
]%% 
public&& 
async&& 
Task&& 
Play&& 
(&& 
[&&  
	Remainder&&  )
]&&) *
string&&* 0
search&&1 7
)&&7 8
{&&9 :
var'' 
player'' 
='' 
_music'' 
.''  
GetLavalinkCluster''  2
(''2 3
)''3 4
.''4 5
	GetPlayer''5 >
<''> ?
Player''? E
>''E F
(''F G
Context''G N
.''N O
Guild''O T
.''T U
Id''U W
)''W X
;''X Y
if(( 
((( 
search(( 
.(( 

StartsWith(( !
(((! "
$str((" (
)((( )
)(() *
{)) 
var** 
result** 
=** 
await** "
_music**# )
.**) *
GetLavalinkCluster*** <
(**< =
)**= >
.**> ?
GetTrackAsync**? L
(**L M
search**M S
,**S T
Lavalink4NET**U a
.**a b
Rest**b f
.**f g

SearchMode**g q
.**q r
None**r v
)**v w
;**w x
if++ 
(++ 
result++ 
!=++ 
null++ "
)++" #
{,, 
if-- 
(-- 
!-- 
result-- 
.--  
IsLiveStream--  ,
)--, -
{.. 
await// 
player// $
.//$ %
	PlayAsync//% .
(//. /
result/// 5
)//5 6
;//6 7
await00 

ReplyAsync00 (
(00( )
$"00) +
Added `00+ 2
{002 3
result003 9
.009 :
Title00: ?
}00? @
 - 00@ C
{00C D
result00D J
.00J K
Author00K Q
}00Q R
` to the queue00R `
"00` a
)00a b
;00b c
}11 
else22 
{33 
await44 

ReplyAsync44 (
(44( )
$str44) K
)44K L
;44L M
}55 
}66 
else77 
await77 

ReplyAsync77 %
(77% &
$str77& L
)77L M
;77M N
}88 
else99 
{:: 
var;; 
provider;; 
=;; 
Lavalink4NET;; +
.;;+ ,
Rest;;, 0
.;;0 1

SearchMode;;1 ;
.;;; <
YouTube;;< C
;;;C D
var<< 
result<< 
=<< 
await<< "
_music<<# )
.<<) *
GetLavalinkCluster<<* <
(<<< =
)<<= >
.<<> ?
GetTracksAsync<<? M
(<<M N
search<<N T
,<<T U
provider<<V ^
)<<^ _
;<<_ `
if== 
(== 
result== 
.== 
Any== 
(== 
)==  
)==  !
{>> 
var?? 
song?? 
=?? 
result?? %
.??% &
First??& +
(??+ ,
)??, -
;??- .
if@@ 
(@@ 
!@@ 
song@@ 
.@@ 
IsLiveStream@@ *
)@@* +
{AA 
awaitBB 
playerBB $
.BB$ %
	PlayAsyncBB% .
(BB. /
songBB/ 3
)BB3 4
;BB4 5
awaitCC 

ReplyAsyncCC (
(CC( )
$"CC) +
Added `CC+ 2
{CC2 3
songCC3 7
.CC7 8
TitleCC8 =
}CC= >
 - CC> A
{CCA B
songCCB F
.CCF G
AuthorCCG M
}CCM N
` to the queueCCN \
"CC\ ]
)CC] ^
;CC^ _
}DD 
elseEE 
{EE 
awaitFF 

ReplyAsyncFF (
(FF( )
$strFF) K
)FFK L
;FFL M
}GG 
}HH 
elseII 
awaitII 

ReplyAsyncII %
(II% &
$strII& @
)II@ A
;IIA B
}JJ 
}KK 	
[LL 	
VoiceLL	 
(LL 
trueLL 
,LL 
trueLL 
)LL 
]LL 
[MM 	
CommandMM	 
(MM 
$strMM 
)MM 
]MM 
publicNN 
asyncNN 
TaskNN 
YouTubeNN !
(NN! "
[NN" #
	RemainderNN# ,
]NN, -
stringNN- 3
searchNN4 :
)NN: ;
{NN< =
varOO 
playerOO 
=OO 
_musicOO 
.OO  
GetLavalinkClusterOO  2
(OO2 3
)OO3 4
.OO4 5
	GetPlayerOO5 >
<OO> ?
PlayerOO? E
>OOE F
(OOF G
ContextOOG N
.OON O
GuildOOO T
.OOT U
IdOOU W
)OOW X
;OOX Y
varPP 
providerPP 
=PP 
Lavalink4NETPP '
.PP' (
RestPP( ,
.PP, -

SearchModePP- 7
.PP7 8
YouTubePP8 ?
;PP? @
varQQ 
resultQQ 
=QQ 
awaitQQ 
_musicQQ %
.QQ% &
GetLavalinkClusterQQ& 8
(QQ8 9
)QQ9 :
.QQ: ;
GetTracksAsyncQQ; I
(QQI J
searchQQJ P
,QQP Q
providerQQR Z
)QQZ [
;QQ[ \
ifRR 
(RR 
resultRR 
.RR 
AnyRR 
(RR 
)RR 
)RR 
{SS 
varTT 
songTT 
=TT 
resultTT !
.TT! "
FirstTT" '
(TT' (
)TT( )
;TT) *
ifUU 
(UU 
!UU 
songUU 
.UU 
IsLiveStreamUU &
)UU& '
{VV 
awaitWW 
playerWW  
.WW  !
	PlayAsyncWW! *
(WW* +
songWW+ /
)WW/ 0
;WW0 1
awaitXX 

ReplyAsyncXX $
(XX$ %
$"XX% '
Added `XX' .
{XX. /
songXX/ 3
.XX3 4
TitleXX4 9
}XX9 :
 - XX: =
{XX= >
songXX> B
.XXB C
AuthorXXC I
}XXI J
` to the queueXXJ X
"XXX Y
)XXY Z
;XXZ [
}YY 
elseZZ 
{[[ 
await\\ 

ReplyAsync\\ $
(\\$ %
$str\\% G
)\\G H
;\\H I
}]] 
}^^ 
else__ 
await__ 

ReplyAsync__ !
(__! "
$str__" <
)__< =
;__= >
}`` 	
[aa 	
Voiceaa	 
(aa 
trueaa 
,aa 
trueaa 
)aa 
]aa 
[bb 	
Commandbb	 
(bb 
$strbb 
)bb 
]bb 
publiccc 
asynccc 
Taskcc 

SoundCloudcc $
(cc$ %
[cc% &
	Remaindercc& /
]cc/ 0
stringcc0 6
searchcc7 =
)cc= >
{dd 	
varee 
playeree 
=ee 
_musicee 
.ee  
GetLavalinkClusteree  2
(ee2 3
)ee3 4
.ee4 5
	GetPlayeree5 >
<ee> ?
Playeree? E
>eeE F
(eeF G
ContexteeG N
.eeN O
GuildeeO T
.eeT U
IdeeU W
)eeW X
;eeX Y
varff 
providerff 
=ff 
Lavalink4NETff '
.ff' (
Restff( ,
.ff, -

SearchModeff- 7
.ff7 8

SoundCloudff8 B
;ffB C
vargg 
resultgg 
=gg 
awaitgg 
_musicgg %
.gg% &
GetLavalinkClustergg& 8
(gg8 9
)gg9 :
.gg: ;
GetTracksAsyncgg; I
(ggI J
searchggJ P
,ggP Q
providerggR Z
)ggZ [
;gg[ \
ifhh 
(hh 
resulthh 
.hh 
Anyhh 
(hh 
)hh 
)hh 
{ii 
varjj 
songjj 
=jj 
resultjj !
.jj! "
Firstjj" '
(jj' (
)jj( )
;jj) *
ifkk 
(kk 
!kk 
songkk 
.kk 
IsLiveStreamkk &
)kk& '
{ll 
awaitmm 
playermm  
.mm  !
	PlayAsyncmm! *
(mm* +
songmm+ /
)mm/ 0
;mm0 1
awaitnn 

ReplyAsyncnn $
(nn$ %
$"nn% '
Added `nn' .
{nn. /
songnn/ 3
.nn3 4
Titlenn4 9
}nn9 :
 - nn: =
{nn= >
songnn> B
.nnB C
AuthornnC I
}nnI J
` to the queuennJ X
"nnX Y
)nnY Z
;nnZ [
}oo 
elsepp 
{qq 
awaitrr 

ReplyAsyncrr $
(rr$ %
$strrr% G
)rrG H
;rrH I
}ss 
}tt 
elseuu 
awaituu 

ReplyAsyncuu !
(uu! "
$struu" <
)uu< =
;uu= >
}vv 	
[xx 	
Voicexx	 
(xx 
truexx 
,xx 
truexx 
)xx 
]xx 
[yy 	
Commandyy	 
(yy 
$stryy 
)yy 
]yy 
publiczz 
asynczz 
Taskzz 
	SetVolumezz #
(zz# $
floatzz$ )
volumezz* 0
)zz0 1
{zz2 3
if{{ 
({{ 
volume{{ 
<={{ 
$num{{ 
&&{{ !
volume{{" (
>{{) *
$num{{+ ,
){{, -
{|| 
var}} 
player}} 
=}} 
_music}} #
.}}# $
GetLavalinkCluster}}$ 6
(}}6 7
)}}7 8
.}}8 9
	GetPlayer}}9 B
<}}B C
Player}}C I
>}}I J
(}}J K
Context}}K R
.}}R S
Guild}}S X
.}}X Y
Id}}Y [
)}}[ \
;}}\ ]
await~~ 
player~~ 
.~~ 
SetVolumeAsync~~ +
(~~+ ,
volume~~, 2
/~~3 4
$num~~5 8
)~~8 9
;~~9 :
await 
player 
. 
Channel $
.$ %
SendMessageAsync% 5
(5 6
$"6 8
Volume set to 8 F
{F G
volumeG M
}M N
%N O
"O P
)P Q
;Q R
}
ÄÄ 
else
ÅÅ 
await
ÇÇ 

ReplyAsync
ÇÇ  
(
ÇÇ  !
$str
ÇÇ! T
)
ÇÇT U
;
ÇÇU V
}
ÉÉ 	
[
ÑÑ 	
Voice
ÑÑ	 
(
ÑÑ 
true
ÑÑ 
,
ÑÑ 
true
ÑÑ 
)
ÑÑ 
]
ÑÑ 
[
ÖÖ 	
Command
ÖÖ	 
(
ÖÖ 
$str
ÖÖ 
)
ÖÖ 
]
ÖÖ 
public
ÜÜ 
async
ÜÜ 
Task
ÜÜ 
Skip
ÜÜ 
(
ÜÜ 
int
ÜÜ "
count
ÜÜ# (
=
ÜÜ) *
$num
ÜÜ+ ,
)
ÜÜ, -
{
ÜÜ. /
var
áá 
player
áá 
=
áá 
_music
áá 
.
áá   
GetLavalinkCluster
áá  2
(
áá2 3
)
áá3 4
.
áá4 5
	GetPlayer
áá5 >
<
áá> ?
Player
áá? E
>
ááE F
(
ááF G
Context
ááG N
.
ááN O
Guild
ááO T
.
ááT U
Id
ááU W
)
ááW X
;
ááX Y
if
àà 
(
àà 
player
àà 
.
àà 
	IsLooping
àà  
)
àà  !
{
àà" #
await
ââ 
player
ââ 
.
ââ 
Channel
ââ $
.
ââ$ %
SendMessageAsync
ââ% 5
(
ââ5 6
$str
ââ6 d
)
ââd e
;
ââe f
return
ää 
;
ää 
}
ãã 
await
åå 
player
åå 
.
åå 
	SkipAsync
åå "
(
åå" #
count
åå# (
)
åå( )
;
åå) *
await
çç 

ReplyAsync
çç 
(
çç 
$"
çç 
I've skiped 
çç +
{
çç+ ,
count
çç, 1
}
çç1 2

 sounds ^^
çç2 <
"
çç< =
)
çç= >
;
çç> ?
}
éé 	
[
èè 	
Voice
èè	 
(
èè 
true
èè 
,
èè 
true
èè 
)
èè 
]
èè 
[
êê 	
Command
êê	 
(
êê 
$str
êê 
)
êê 
]
êê  
public
ëë 
async
ëë 
Task
ëë 
ChangeChannel
ëë '
(
ëë' (
IMessageChannel
ëë( 7
socketChannel
ëë8 E
=
ëëF G
null
ëëH L
)
ëëL M
{
ëëN O
if
íí 
(
íí 
socketChannel
íí 
==
íí  
null
íí! %
)
íí% &
socketChannel
ìì 
=
ìì 
Context
ìì  '
.
ìì' (
Channel
ìì( /
;
ìì/ 0
var
îî 
player
îî 
=
îî 
_music
îî 
.
îî   
GetLavalinkCluster
îî  2
(
îî2 3
)
îî3 4
.
îî4 5
	GetPlayer
îî5 >
<
îî> ?
Player
îî? E
>
îîE F
(
îîF G
Context
îîG N
.
îîN O
Guild
îîO T
.
îîT U
Id
îîU W
)
îîW X
;
îîX Y
player
ïï 
.
ïï 
Channel
ïï 
=
ïï 
socketChannel
ïï *
;
ïï* +
await
ññ 
socketChannel
ññ 
.
ññ  
SendFileAsync
ññ  -
(
ññ- .
$str
ññ. [
)
ññ[ \
;
ññ\ ]
}
óó 	
[
ôô 	
Voice
ôô	 
(
ôô 
true
ôô 
,
ôô 
true
ôô 
)
ôô 
]
ôô 
[
öö 	
Command
öö	 
(
öö 
$str
öö 
)
öö 
]
öö 
public
õõ 
async
õõ 
Task
õõ 
Queue
õõ 
(
õõ  
)
õõ  !
{
õõ" #
var
úú 
player
úú 
=
úú 
_music
úú 
.
úú   
GetLavalinkCluster
úú  2
(
úú2 3
)
úú3 4
.
úú4 5
	GetPlayer
úú5 >
<
úú> ?
Player
úú? E
>
úúE F
(
úúF G
Context
úúG N
.
úúN O
Guild
úúO T
.
úúT U
Id
úúU W
)
úúW X
;
úúX Y
if
ùù 
(
ùù 
player
ùù 
.
ùù 
Channel
ùù 
==
ùù !
null
ùù" &
)
ùù& '
player
ùù( .
.
ùù. /
Channel
ùù/ 6
=
ùù7 8
Context
ùù9 @
.
ùù@ A
Channel
ùùA H
;
ùùH I
var
ûû 
queue
ûû 
=
ûû 
player
ûû 
.
ûû 
Queue
ûû $
;
ûû$ %
if
†† 
(
†† 
queue
†† 
.
†† 
Count
†† 
==
†† 
$num
††  
)
††  !
{
††" #
await
††$ )

ReplyAsync
††* 4
(
††4 5
$str
††5 T
)
††T U
;
††U V
return
††W ]
;
††] ^
}
††_ `
var
°° 
sb
°° 
=
°° 
new
°° 
StringBuilder
°° &
(
°°& '
$"
°°' )
	There is 
°°) 2
{
°°2 3
queue
°°3 8
.
°°8 9
Count
°°9 >
}
°°> ?)
 song(s) in the queue :\r\n
°°? Z
"
°°Z [
)
°°[ \
;
°°\ ]
foreach
¢¢ 
(
¢¢ 
var
¢¢ 
song
¢¢ 
in
¢¢  
queue
¢¢! &
)
¢¢& '
{
¢¢( )
sb
££ 
.
££ 
Append
££ 
(
££ 
$str
££ $
)
££$ %
.
££% &
Append
££& ,
(
££, -
song
££- 1
.
££1 2
Title
££2 7
)
££7 8
.
££8 9
Append
££9 ?
(
££? @
$str
££@ E
)
££E F
.
££F G
Append
££G M
(
££M N
song
££N R
.
££R S
Author
££S Y
)
££Y Z
.
££Z [
Append
££[ a
(
££a b
$str
££b i
)
££i j
;
££j k
}
§§ 
await
•• 

ReplyAsync
•• 
(
•• 
embed
•• "
:
••" #
new
••$ '
EmbedBuilder
••( 4
(
••4 5
)
••5 6
{
¶¶ 
Title
ßß 
=
ßß 
$str
ßß ,
,
ßß, -
Description
®® 
=
®® 
sb
®®  
.
®®  !
ToString
®®! )
(
®®) *
)
®®* +
}
©© 
.
©© 
WithRandomColor
©© 
(
©© 
)
©© 
.
©©  
Build
©©  %
(
©©% &
)
©©& '
)
©©' (
;
©©( )
}
™™ 	
[
´´ 	
Voice
´´	 
(
´´ 
true
´´ 
,
´´ 
true
´´ 
)
´´ 
]
´´ 
[
¨¨ 	
Command
¨¨	 
(
¨¨ 
$str
¨¨ 
)
¨¨ 
]
¨¨ 
public
≠≠ 
async
≠≠ 
Task
≠≠ 
	StopMusic
≠≠ #
(
≠≠# $
)
≠≠$ %
{
≠≠& '
var
ÆÆ 
player
ÆÆ 
=
ÆÆ 
_music
ÆÆ 
.
ÆÆ   
GetLavalinkCluster
ÆÆ  2
(
ÆÆ2 3
)
ÆÆ3 4
.
ÆÆ4 5
	GetPlayer
ÆÆ5 >
<
ÆÆ> ?
Player
ÆÆ? E
>
ÆÆE F
(
ÆÆF G
Context
ÆÆG N
.
ÆÆN O
Guild
ÆÆO T
.
ÆÆT U
Id
ÆÆU W
)
ÆÆW X
;
ÆÆX Y
await
ØØ 
player
ØØ 
.
ØØ 
DestroyAsync
ØØ %
(
ØØ% &
)
ØØ& '
;
ØØ' (
await
∞∞ 

ReplyAsync
∞∞ 
(
∞∞ 
$str
∞∞ 0
)
∞∞0 1
;
∞∞1 2
}
±± 	
[
≤≤ 	
Voice
≤≤	 
(
≤≤ 
true
≤≤ 
,
≤≤ 
true
≤≤ 
)
≤≤ 
]
≤≤ 
[
≥≥ 	
Command
≥≥	 
(
≥≥ 
$str
≥≥ 
)
≥≥ 
]
≥≥ 
public
¥¥ 
async
¥¥ 
Task
¥¥ 
Pause
¥¥ 
(
¥¥  
)
¥¥  !
{
¥¥" #
var
µµ 
player
µµ 
=
µµ 
_music
µµ 
.
µµ   
GetLavalinkCluster
µµ  2
(
µµ2 3
)
µµ3 4
.
µµ4 5
	GetPlayer
µµ5 >
<
µµ> ?
Player
µµ? E
>
µµE F
(
µµF G
Context
µµG N
.
µµN O
Guild
µµO T
.
µµT U
Id
µµU W
)
µµW X
;
µµX Y
if
∂∂ 
(
∂∂ 
player
∂∂ 
.
∂∂ 
State
∂∂ 
==
∂∂ 
Lavalink4NET
∂∂  ,
.
∂∂, -
Player
∂∂- 3
.
∂∂3 4
PlayerState
∂∂4 ?
.
∂∂? @
Paused
∂∂@ F
)
∂∂F G
{
∑∑ 
await
∏∏ 
player
∏∏ 
.
∏∏ 
ResumeAsync
∏∏ (
(
∏∏( )
)
∏∏) *
;
∏∏* +
await
ππ 
player
ππ 
.
ππ 
Channel
ππ $
.
ππ$ %
SendMessageAsync
ππ% 5
(
ππ5 6
$str
ππ6 I
)
ππI J
;
ππJ K
}
∫∫ 
else
ªª 
{
ªª 
await
ºº 
player
ºº 
.
ºº 

PauseAsync
ºº '
(
ºº' (
)
ºº( )
;
ºº) *
await
ΩΩ 
player
ΩΩ 
.
ΩΩ 
Channel
ΩΩ $
.
ΩΩ$ %
SendMessageAsync
ΩΩ% 5
(
ΩΩ5 6
$str
ΩΩ6 H
)
ΩΩH I
;
ΩΩI J
}
ææ 
}
øø 	
[
¿¿ 	
Voice
¿¿	 
(
¿¿ 
true
¿¿ 
,
¿¿ 
true
¿¿ 
)
¿¿ 
]
¿¿ 
[
¡¡ 	
Command
¡¡	 
(
¡¡ 
$str
¡¡ 
)
¡¡ 
]
¡¡ 
public
¬¬ 
async
¬¬ 
Task
¬¬ 
Loop
¬¬ 
(
¬¬ 
)
¬¬  
{
√√ 	
var
ƒƒ 
player
ƒƒ 
=
ƒƒ 
_music
ƒƒ 
.
ƒƒ   
GetLavalinkCluster
ƒƒ  2
(
ƒƒ2 3
)
ƒƒ3 4
.
ƒƒ4 5
	GetPlayer
ƒƒ5 >
<
ƒƒ> ?
Player
ƒƒ? E
>
ƒƒE F
(
ƒƒF G
Context
ƒƒG N
.
ƒƒN O
Guild
ƒƒO T
.
ƒƒT U
Id
ƒƒU W
)
ƒƒW X
;
ƒƒX Y
player
≈≈ 
.
≈≈ 
	IsLooping
≈≈ 
=
≈≈ 
!
≈≈  
player
≈≈  &
.
≈≈& '
	IsLooping
≈≈' 0
;
≈≈0 1
await
∆∆ 
player
∆∆ 
.
∆∆ 
Channel
∆∆  
.
∆∆  !
SendMessageAsync
∆∆! 1
(
∆∆1 2
$"
∆∆2 4
	Looping: 
∆∆4 =
{
∆∆= >
(
∆∆> ?
player
∆∆? E
.
∆∆E F
	IsLooping
∆∆F O
?
∆∆P Q
$str
∆∆R [
:
∆∆\ ]
$str
∆∆^ h
)
∆∆h i
}
∆∆i j
"
∆∆j k
)
∆∆k l
;
∆∆l m
}
«« 	
[
»» 	
Command
»»	 
(
»» 
$str
»» 
)
»» 
]
»» 
[
…… 	
Alias
……	 
(
…… 
new
…… 
[
…… 
]
…… 
{
…… 
$str
…… 
,
…… 
$str
…… &
}
……' (
)
……( )
]
……) *
public
   
async
   
Task
   

NowPlaying
   $
(
  $ %
)
  % &
{
  ' (
var
ÀÀ 
player
ÀÀ 
=
ÀÀ 
_music
ÀÀ 
.
ÀÀ   
GetLavalinkCluster
ÀÀ  2
(
ÀÀ2 3
)
ÀÀ3 4
.
ÀÀ4 5
	GetPlayer
ÀÀ5 >
<
ÀÀ> ?
Player
ÀÀ? E
>
ÀÀE F
(
ÀÀF G
Context
ÀÀG N
.
ÀÀN O
Guild
ÀÀO T
.
ÀÀT U
Id
ÀÀU W
)
ÀÀW X
;
ÀÀX Y
var
ÃÃ 
embed
ÃÃ 
=
ÃÃ 
new
ÃÃ 
EmbedBuilder
ÃÃ (
(
ÃÃ( )
)
ÃÃ) *
{
ÃÃ+ ,
Title
ÕÕ 
=
ÕÕ 
player
ÕÕ 
.
ÕÕ 
CurrentTrack
ÕÕ +
.
ÕÕ+ ,
Title
ÕÕ, 1
,
ÕÕ1 2
Description
ŒŒ 
=
ŒŒ 
MakeBar
ŒŒ %
(
ŒŒ% &
player
ŒŒ& ,
.
ŒŒ, -
CurrentTrack
ŒŒ- 9
.
ŒŒ9 :
Duration
ŒŒ: B
,
ŒŒB C
player
ŒŒC I
.
ŒŒI J
TrackPosition
ŒŒJ W
)
ŒŒW X
,
ŒŒX Y
Fields
œœ 
=
œœ 
new
œœ 
System
œœ #
.
œœ# $
Collections
œœ$ /
.
œœ/ 0
Generic
œœ0 7
.
œœ7 8
List
œœ8 <
<
œœ< =
EmbedFieldBuilder
œœ= N
>
œœN O
(
œœO P
)
œœP Q
{
œœR S
new
–– 
EmbedFieldBuilder
–– )
(
––) *
)
––* +
{
––, -
IsInline
——  
=
——! "
true
——# '
,
——' (
Name
““ 
=
““ 
$str
““ '
,
““' (
Value
”” 
=
”” 
player
””  &
.
””& '
CurrentTrack
””' 3
.
””3 4
Author
””4 :
}
‘‘ 
,
‘‘ 
new
‘‘ 
EmbedFieldBuilder
‘‘ ,
(
‘‘, -
)
‘‘- .
{
‘‘/ 0
IsInline
’’  
=
’’! "
true
’’# '
,
’’' (
Name
÷÷ 
=
÷÷ 
$str
÷÷ +
,
÷÷+ ,
Value
◊◊ 
=
◊◊ 
player
◊◊  &
.
◊◊& '
CurrentTrack
◊◊' 3
.
◊◊3 4
Provider
◊◊4 <
}
ÿÿ 
}
ŸŸ 
}
⁄⁄ 
.
⁄⁄ 
WithRandomColor
⁄⁄ 
(
⁄⁄ 
)
⁄⁄ 
.
⁄⁄  
Build
⁄⁄  %
(
⁄⁄% &
)
⁄⁄& '
;
⁄⁄' (
await
€€ 

ReplyAsync
€€ 
(
€€ 
embed
€€ "
:
€€" #
embed
€€$ )
)
€€) *
;
€€* +
}
‹‹ 	
private
›› 
string
›› 
MakeBar
›› 
(
›› 
TimeSpan
›› '
duration
››( 0
,
››0 1
TimeSpan
››2 :
trackPosition
››; H
)
››H I
{
ﬁﬁ 	
const
ﬂﬂ 
int
ﬂﬂ 
count
ﬂﬂ 
=
ﬂﬂ 
$num
ﬂﬂ  
;
ﬂﬂ  !
const
‡‡ 
char
‡‡ 
progress
‡‡ 
=
‡‡  !
$char
‡‡" %
;
‡‡% &
var
·· 

firstcount
·· 
=
·· 
Convert
·· $
.
··$ %
ToInt32
··% ,
(
··, -
(
··- .
trackPosition
··. ;
.
··; <
TotalSeconds
··< H
*
··I J
count
··K P
)
··P Q
/
··R S
duration
··T \
.
··\ ]
TotalSeconds
··] i
)
··i j
;
··j k
return
‚‚ 
$"
‚‚ 
`[
‚‚ 
{
‚‚ 
new
‚‚ 
String
‚‚ "
(
‚‚" #
progress
‚‚# +
,
‚‚+ ,

firstcount
‚‚, 6
)
‚‚6 7
}
‚‚7 8
>
‚‚8 9
{
‚‚9 :
new
‚‚: =
String
‚‚> D
(
‚‚D E
progress
‚‚E M
,
‚‚M N
count
‚‚N S
-
‚‚T U

firstcount
‚‚V `
)
‚‚` a
}
‚‚a b
] 
‚‚b d
{
‚‚d e
(
‚‚e f
trackPosition
‚‚f s
)
‚‚s t
.
‚‚t u
ToHumanReadable‚‚u Ñ
(‚‚Ñ Ö
)‚‚Ö Ü
}‚‚Ü á
/‚‚á à
{‚‚à â
duration‚‚â ë
.‚‚ë í
ToHumanReadable‚‚í °
(‚‚° ¢
)‚‚¢ £
}‚‚£ §
`‚‚§ •
"‚‚• ¶
;‚‚¶ ß
}
„„ 	
}
‰‰ 
}ÂÂ ¯
_C:\Users\Matthieu\source\repos\HeroBot-deux-point-z√©ro\HeroBot.Plugins.Music\PluginRefferal.cs
	namespace 	
HeroBot
 
. 
Plugins 
. 
Music 
{ 
public 

class 
PluginRefferal 
:  !
IPluginRefferal" 1
{ 
} 
} Œ
fC:\Users\Matthieu\source\repos\HeroBot-deux-point-z√©ro\HeroBot.Plugins.Music\Services\MusicService.cs
	namespace		 	
HeroBot		
 
.		 
Plugins		 
.		 
Music		 
.		  
Services		  (
{

 
[ 
Service 
] 
public 

class 
MusicService 
{ 
private 
LavalinkCluster 
lavalinkCluster  /
;/ 0
private %
InactivityTrackingService )
inactivityTracker* ;
;; <
private  
DiscordClientWrapper $ 
discordClientWrapper% 9
;9 :
public 
MusicService 
(  
DiscordShardedClient 0 
discordShardedclient1 E
)E F
{ 	 
discordShardedclient  
.  !

ShardReady! +
+=, .+
DiscordShardedclient_ShardReady/ N
;N O
} 	
internal 
LavalinkCluster  
GetLavalinkCluster! 3
(3 4
)4 5
{6 7
return8 >
lavalinkCluster? N
;N O
}P Q
private 
async 
System 
. 
	Threading &
.& '
Tasks' ,
., -
Task- 1+
DiscordShardedclient_ShardReady2 Q
(Q R
DiscordSocketClientR e
argf i
)i j
{ 	 
discordClientWrapper  
=! "
new# & 
DiscordClientWrapper' ;
(; <
arg< ?
)? @
;@ A
lavalinkCluster 
= 
new !
LavalinkCluster" 1
(1 2
new2 5"
LavalinkClusterOptions6 L
(L M
)M N
{ 

StayOnline   
=   
true   !
,  ! "
Nodes!! 
=!! 
new!! 
[!! 
]!! 
{!! 
new!!  #
Lavalink4NET!!$ 0
.!!0 1
LavalinkNodeOptions!!1 D
(!!D E
)!!E F
{"" 
RestUri## 
=## 
$"##  0
$http://lavalink.alivecreation.fr:80/##  D
"##D E
,##E F
WebSocketUri$$  
=$$! "
$"$$# %.
"ws://lavalink.alivecreation.fr:80/$$% G
"$$G H
,$$H I
Password%% 
=%% 
Uri%% "
.%%" #
EscapeDataString%%# 3
(%%3 4
$str	%%4 ∂
)
%%∂ ∑
,
%%∑ ∏
AllowResuming&& !
=&&" #
true&&$ (
}'' 
,'' 
}(( 
,((  
LoadBalacingStrategy** $
=**% &#
LoadBalancingStrategies**' >
.**> ?
LoadStrategy**? K
}++ 
,++  
discordClientWrapper++ #
)++# $
;++$ %
await,, 
lavalinkCluster,, !
.,,! "
InitializeAsync,," 1
(,,1 2
),,2 3
;,,3 4
inactivityTracker-- 
=-- 
new--  #%
InactivityTrackingService--$ =
(--= >
lavalinkCluster--> M
,--M N 
discordClientWrapper--O c
,--c d
new--e h&
InactivityTrackingOptions	--i Ç
(
--Ç É
)
--É Ñ
{.. 
DisconnectDelay// 
=//  !
TimeSpan//" *
.//* +
FromSeconds//+ 6
(//6 7
$num//7 9
)//9 :
,//: ;
PollInterval22 
=22 
TimeSpan22 '
.22' (
FromSeconds22( 3
(223 4
$num224 5
)225 6
,226 7
TrackInactivity55 
=55  !
true55" &
}66 
)66 
;66 
}77 	
}88 
}99 ü
`C:\Users\Matthieu\source\repos\HeroBot-deux-point-z√©ro\HeroBot.Plugins.Music\Services\Player.cs
	namespace 	
HeroBot
 
. 
Plugins 
. 
Music 
.  
Services  (
{ 
class 	
Player
 
:  
QueuedLavalinkPlayer '
{ 
internal 
IMessageChannel  
Channel! (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
Player 
( 
LavalinkSocket $
lavalinkSocket% 3
,3 4!
IDiscordClientWrapper5 J
clientK Q
,Q R
ulongS X
guildIdY `
,` a
boolb f
disconnectOnStopg w
)w x
:y z
base{ 
(	 Ä
lavalinkSocket
Ä é
,
é è
client
ê ñ
,
ñ ó
guildId
ò ü
,
ü †
disconnectOnStop
° ±
)
± ≤
{ 	
} 	
public 
override 
async 
Task "
OnTrackEndAsync# 2
(2 3
TrackEndEventArgs3 D
	eventArgsE N
)N O
{ 	
await 
base 
. 
OnTrackEndAsync &
(& '
	eventArgs' 0
)0 1
;1 2
if 
( 
	eventArgs 
. 
MayStartNext %
&&& (
!) *
Queue* /
./ 0
IsEmpty0 7
&&8 :
!; <
	IsLooping< E
)E F
await 
this 
. 
Channel "
." #
SendMessageAsync# 3
(3 4
$"4 6
Now playing `6 C
{C D
CurrentTrackD P
.P Q
TitleQ V
}V W
` :play:W _
"_ `
)` a
;a b
} 	
} 
} 